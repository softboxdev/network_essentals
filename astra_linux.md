
## üîÑ –û–±—â–∞—è —Å—Ö–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–æ–≤

### 1. –î–∏–∞–≥—Ä–∞–º–º–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```mermaid
sequenceDiagram
    participant A as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    participant ALD as ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä<br/>Astra Linux
    participant AD as Microsoft AD
    participant S as Samba Server
    participant C as –ö–ª–∏–µ–Ω—Ç Windows

    Note over A, C: –≠–¢–ê–ü 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    
    A->>ALD: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ astra-domain-admin
    ALD-->>A: –ü–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
    A->>ALD: ald-provision (—Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞)
    ALD-->>A: –î–æ–º–µ–Ω astra.local —Å–æ–∑–¥–∞–Ω
    
    A->>AD: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–≤–µ—Ä–∏—è ald_trust
    AD-->>A: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
    
    A->>S: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Samba
    S-->>A: Samba —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    A->>S: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ smb.conf
    S-->>A: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
    
    Note over A, C: –≠–¢–ê–ü 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
    
    A->>S: net ads join -U administrator
    S->>AD: –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –¥–æ–º–µ–Ω—É
    AD-->>S: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ + –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å
    S-->>A: –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω –∫ –¥–æ–º–µ–Ω—É
    
    A->>ALD: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ krb5.conf (–¥–æ–≤–µ—Ä–∏–µ)
    A->>AD: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ conditional forwarders DNS
```

### 2. –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è AD –Ω–∞ Linux-—Ö–æ—Å—Ç–µ

```mermaid
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å AD
    participant C as –ö–ª–∏–µ–Ω—Ç Windows
    participant AD as Microsoft AD
    participant S as Samba Server<br/>Astra Linux
    participant ALD as ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
    participant PAM as PAM-–º–æ–¥—É–ª—å

    Note over U, PAM: –°–¶–ï–ù–ê–†–ò–ô: –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è AD –Ω–∞ Linux-—Å–µ—Ä–≤–µ—Ä
    
    U->>C: –õ–æ–≥–∏–Ω –≤ Windows (company.local)
    C->>AD: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è Kerberos
    AD-->>C: TGT-–±–∏–ª–µ—Ç –ø–æ–ª—É—á–µ–Ω
    
    U->>S: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ SSH/—Å–µ—Ä–≤–∏—Å—É
    S->>PAM: –ó–∞–ø—Ä–æ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    PAM->>S: winbind –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    S->>AD: –ó–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    AD-->>S: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    S->>ALD: –ó–∞–ø—Ä–æ—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ALD-->>S: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö
    
    S-->>U: –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!<br/>–°–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞
```

### 3. –î–∏–∞–≥—Ä–∞–º–º–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º Samba

```mermaid
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å AD
    participant C as –ö–ª–∏–µ–Ω—Ç Windows
    participant AD as Microsoft AD
    participant S as Samba Server<br/>Astra Linux
    participant FS as –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

    Note over U, FS: –°–¶–ï–ù–ê–†–ò–ô: –î–æ—Å—Ç—É–ø –∫ –æ–±—â–µ–π –ø–∞–ø–∫–µ Samba
    
    U->>C: \\samba-server\shared
    C->>AD: –ó–∞–ø—Ä–æ—Å Kerberos-–±–∏–ª–µ—Ç–∞ –¥–ª—è CIFS
    AD-->>C: Service ticket –¥–ª—è Samba
    
    C->>S: SMB-–∑–∞–ø—Ä–æ—Å —Å Kerberos-–±–∏–ª–µ—Ç–æ–º
    S->>AD: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–ª–µ—Ç–∞
    AD-->>S: –ë–∏–ª–µ—Ç –≤–∞–ª–∏–¥–µ–Ω
    
    S->>FS: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ /srv/samba/shared
    FS-->>S: –ü—Ä–∞–≤–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã
    
    S->>S: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ SID‚ÜîUID (idmap)
    S-->>C: –î–æ—Å—Ç—É–ø –∫ –ø–∞–ø–∫–µ —Ä–∞–∑—Ä–µ—à–µ–Ω
    C-->>U: –û—Ç–∫—Ä—ã—Ç–∞ –æ–±—â–∞—è –ø–∞–ø–∫–∞
```

### 4. –î–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```mermaid
sequenceDiagram
    participant A as –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    participant AD as Microsoft AD
    participant PS as PowerShell
    participant ALD as ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
    participant S as Samba

    Note over A, S: –≠–¢–ê–ü 3: –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    
    A->>PS: Get-ADUser -Filter *
    PS->>AD: –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    AD-->>PS: CSV —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
    PS-->>A: –§–∞–π–ª users.csv
    
    loop –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        A->>ALD: ipa user-add --first=–ò–º—è --last=–§–∞–º–∏–ª–∏—è
        ALD-->>A: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
        A->>ALD: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
        ALD-->>A: –ü–∞—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    end
    
    Note over A, S: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–æ–º–µ–Ω–æ–≤
    A->>S: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–ª—è mixed-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    S-->>A: –ü—Ä–∞–≤–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
    
    Note over A, S: –ü–æ—Å—Ç–µ–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
    A->>AD: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
    AD-->>A: –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
```

### 5. –î–∏–∞–≥—Ä–∞–º–º–∞ DNS-—Ä–µ–∑–æ–ª–≤–∏–Ω–≥–∞ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏

```mermaid
sequenceDiagram
    participant C as –ö–ª–∏–µ–Ω—Ç
    participant ALD as ALD DNS
    participant AD as AD DNS
    participant F –∫–∞–∫ Forwarder

    Note over C, F: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ö–û–ú–ü–û–ù–ï–ù–¢: DNS-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
    
    C->>ALD: –ó–∞–ø—Ä–æ—Å company.local
    ALT Conditional Forwarding –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        ALD->>AD: –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
        AD-->>ALD: DNS-–æ—Ç–≤–µ—Ç
        ALD-->>C: –í–æ–∑–≤—Ä–∞—Ç IP-–∞–¥—Ä–µ—Å–æ–≤
    ELSE Forwarding –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        ALD->>F: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π forwarder (8.8.8.8)
        F-->>ALD: NXDOMAIN (–¥–æ–º–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω)
        ALD-->>C: –û—à–∏–±–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
    end
    
    C->>AD: –ó–∞–ø—Ä–æ—Å astra.local
    ALT Conditional Forwarding –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        AD->>ALD: –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
        ALD-->>AD: DNS-–æ—Ç–≤–µ—Ç
        AD-->>C: –í–æ–∑–≤—Ä–∞—Ç IP-–∞–¥—Ä–µ—Å–æ–≤
    ELSE Forwarding –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        AD->>F: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π forwarder
        F-->>AD: NXDOMAIN
        AD-->>C: –û—à–∏–±–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
    end
```

### 6. –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–∫–≤–æ–∑–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Single Sign-On)

```mermaid
sequenceDiagram
    participant U as –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    participant C as –†–∞–±–æ—á–∞—è —Å—Ç–∞–Ω—Ü–∏—è
    participant AD as Microsoft AD
    participant S as Samba/ALD —Å–µ—Ä–≤–∏—Å
    participant K –∫–∞–∫ Kerberos

    Note over U, K: –ò–î–ï–ê–õ–¨–ù–ê–Ø –°–•–ï–ú–ê: –ï–¥–∏–Ω—ã–π –≤—Ö–æ–¥
    
    U->>C: –í—Ö–æ–¥ –≤ Windows-–¥–æ–º–µ–Ω
    C->>AD: –ó–∞–ø—Ä–æ—Å TGT
    AD-->>C: Kerberos TGT –ø–æ–ª—É—á–µ–Ω
    
    U->>C: –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-—Å–µ—Ä–≤–∏—Å—É –Ω–∞ ALD
    C->>K: –ó–∞–ø—Ä–æ—Å service ticket –¥–ª—è HTTP/service.astra.local
    K->>AD: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–≤–µ—Ä–∏—è –º–µ–∂–¥—É REALMS
    AD-->>K: –î–æ–≤–µ—Ä–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
    K-->>C: Service ticket –≤—ã–¥–∞–Ω
    
    C->>S: –ó–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–∏—Å—É —Å Kerberos-–±–∏–ª–µ—Ç–æ–º
    S->>K: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–ª–µ—Ç–∞
    K-->>S: –ë–∏–ª–µ—Ç –≤–∞–ª–∏–¥–µ–Ω
    S-->>U: –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω<br/>(–ë–ï–ó –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è!)
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

1. **DNS** - –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–≥–æ, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∑–∞–∏–º–Ω—ã–π —Ä–µ–∑–æ–ª–≤–∏–Ω–≥
2. **Kerberos Trust** - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é  
3. **Samba Domain Member** - –º–æ—Å—Ç –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏
4. **Winbind/PAM** - –ø–æ–∑–≤–æ–ª—è–µ—Ç Linux "–≤–∏–¥–µ—Ç—å" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π AD
5. **Idmap** - —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏


### –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ —Ç–µ—Ä–º–∏–Ω—ã

*   **FreeIPA / ALD (Astra Linux Domain)** ‚Äî —ç—Ç–æ –¥–æ–º–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ Linux, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –∏ LDAP. ALD ‚Äî —ç—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –ø–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ FreeIPA.
*   **Microsoft AD (Active Directory)** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–µ-—Ñ–∞–∫—Ç–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º–∏ –≤ —Å–µ—Ç—è—Ö Windows.
*   **Samba DC (Domain Controller)** ‚Äî —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ AD –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ Samba. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç Linux-—Å–µ—Ä–≤–µ—Ä—É —Å—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º –¥–æ–º–µ–Ω–∞ AD, "–≥–æ–≤–æ—Ä—è—â–∏–º" –Ω–∞ —Ç–æ–º –∂–µ —è–∑—ã–∫–µ, —á—Ç–æ –∏ Windows-—Å–µ—Ä–≤–µ—Ä—ã.
*   **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –∫–æ–≥–¥–∞ –¥–≤–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏, –Ω–æ –∫–∞–∂–¥–∞—è —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
*   **–ú–∏–≥—Ä–∞—Ü–∏—è** ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–æ–±—ã—á–Ω–æ AD) –≤ –¥—Ä—É–≥—É—é (–æ–±—ã—á–Ω–æ ALD/FreeIPA).

---

### –ü–ª–∞–Ω: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Astra Linux

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–æ–º–µ–Ω Microsoft AD –∏ –º—ã —Ö–æ—Ç–∏–º –≤–Ω–µ–¥—Ä–∏—Ç—å Astra Linux Domain (ALD), –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö, –∞ –∑–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å.

#### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1.  **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –Ω–∞ Astra Linux.**
    *   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–∏—Å—Ç—É—é Astra Linux (—Ä–µ–ª–∏–∑ "–°–º–æ–ª–µ–Ω—Å–∫" –∏–ª–∏ "–û—Ä–µ–ª").
    *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `astra-domain-admin` –∏–ª–∏ —É—Ç–∏–ª–∏—Ç—É `ald-provision` –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.
    *   –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –¥–æ–º–µ–Ω, –Ω–∞–ø—Ä–∏–º–µ—Ä `astra.local`.
    *   –ó–∞–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø—ã. –≠—Ç–æ –±—É–¥–µ—Ç –≤–∞—à "–ø–ª–∞—Ü–¥–∞—Ä–º".

2.  **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Microsoft AD.**
    *   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–º–µ–Ω–∞.
    *   –°–æ–∑–¥–∞–π—Ç–µ –≤ AD —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–æ–≤–µ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ald_trust`). –≠—Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ "—Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏—è" –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏.

#### –≠—Ç–∞–ø 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –î–æ–≤–µ—Ä–∏–µ (Trust) –∏ Samba

–≠—Ç–æ **–∫–ª—é—á–µ–≤–æ–π —ç—Ç–∞–ø** –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –ú—ã —Å–æ–∑–¥–∞–¥–∏–º "–º–æ—Å—Ç" –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏.

1.  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Samba –≤ —Ä–æ–ª–∏ –ß–ª–µ–Ω–∞ –î–æ–º–µ–Ω–∞ (Domain Member) –∏–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ —Å –¥–æ–≤–µ—Ä–∏–µ–º.**
    *   –ù–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ Astra Linux (–∏–ª–∏ –Ω–∞ —Ç–æ–º –∂–µ ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ, –Ω–æ —ç—Ç–æ –º–µ–Ω–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Samba.
    *   **–°—Ü–µ–Ω–∞—Ä–∏–π –ê (–ü—Ä–æ—Å—Ç–æ–π, –¥–ª—è –æ–±—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º):** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Samba –∫–∞–∫ —á–ª–µ–Ω –¥–æ–º–µ–Ω–∞ AD (`security = ads`). –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ AD –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ —à–∞—Ä—ã Astra Linux, –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–∏ AD-—É—á–µ—Ç–∫–∏.
    *   **–°—Ü–µ–Ω–∞—Ä–∏–π –ë (–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è):** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Samba –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è **–¥–æ–≤–µ—Ä–∏—è –º–µ–∂–¥—É –ª–µ—Å–∞–º–∏ (Forest Trust)** –º–µ–∂–¥—É –≤–∞—à–∏–º ALD –∏ AD. –≠—Ç–æ —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
        *   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ AD –≤—Ö–æ–¥–∏—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –≤ –¥–æ–º–µ–Ω–µ ALD (–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç).
        *   –ï–¥–∏–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Kerberos).

2.  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—Ä–æ—Å—Å-—Ä–µ–∞–ª–º–Ω–æ–≥–æ –¥–æ–≤–µ—Ä–∏—è –≤ Kerberos.**
    *   –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö Krb5 (`/etc/krb5.conf`) –∫–∞–∫ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ ALD, —Ç–∞–∫ –∏ (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏) –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ AD, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –∏–∑ –¥–æ–º–µ–Ω–æ–≤, —á—Ç–æ–±—ã –æ–Ω–∏ –º–æ–≥–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –ø–æ—Å–ª–µ –≠—Ç–∞–ø–∞ 2:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ AD —Å–º–æ–≥—É—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º Astra Linux (—á–µ—Ä–µ–∑ PAM), –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º –ø–∞–ø–∫–∞–º (Samba), –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –°–∏—Å—Ç–µ–º—ã –±—É–¥—É—Ç "–≤–∏–¥–µ—Ç—å" –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

---

#### –≠—Ç–∞–ø 3: –ú–∏–≥—Ä–∞—Ü–∏—è (–ü–µ—Ä–µ—Å–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤)

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º–æ—Å—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω, –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –ø–µ—Ä–µ–Ω–æ—Å.

1.  **–ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø.**
    *   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `ipa user-add` –∏ `ldapadd`, –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã.
    *   **–ü—Ä–æ—Ü–µ—Å—Å:**
        *   –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ AD (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PowerShell: `Get-ADUser`).
        *   –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω—è—Ç–Ω—ã–π –¥–ª—è ALD/FreeIPA.
        *   –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ ALD. **–í–∞–∂–Ω–æ:** –ü–∞—Ä–æ–ª–∏ –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è! –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ª–∏–±–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã, —Ç—Ä–µ–±—É—é—â–∏–µ —Å–ª–æ–∂–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
        *   –õ—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –∑–∞–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ ALD, –æ—Å—Ç–∞–≤–∏—Ç—å –∏—Ö –≤ AD, –Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å UPN (User Principal Name) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∏ –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –Ω–∞ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–∞.

2.  **–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ Linux-–∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –∫ ALD.**
    *   –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ. –ù–∞ –ª—é–±–æ–π Astra Linux –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `astra-domain-join` –∏–ª–∏ `ipa-client-install`, —á—Ç–æ–±—ã –∫–æ–º–ø—å—é—Ç–µ—Ä —Å—Ç–∞–ª —á–ª–µ–Ω–æ–º –¥–æ–º–µ–Ω–∞ ALD. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ ALD (–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è –¥–æ–≤–µ—Ä–∏—é, –∏–∑ AD) —Å–º–æ–≥—É—Ç –Ω–∞ –Ω–µ–≥–æ –∑–∞—Ö–æ–¥–∏—Ç—å.

3.  **–ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—â–∏—Ö –ø–∞–ø–æ–∫ –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (Samba).**
    *   –ï—Å–ª–∏ —É –≤–∞—Å –±—ã–ª–∏ —Ñ–∞–π–ª–æ–≤—ã–µ —à–∞—Ä—ã –Ω–∞ Windows-—Å–µ—Ä–≤–µ—Ä–∞—Ö, –∏—Ö –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å Samba –ø–æ–¥ Astra Linux.
    *   –ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ —Ñ–∞–π–ª—ã.
    *   –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (ACL), –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤—Ä–æ–¥–µ `getfacl` / `setfacl`, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∞, –≤—ã–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø AD, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–∏ –∏ –≤ –Ω–æ–≤–æ–º –¥–æ–º–µ–Ω–µ.

---


## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. –§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

```mermaid
graph TB
    subgraph "–°–µ—Ç—å –∫–æ–º–ø–∞–Ω–∏–∏ (192.168.1.0/24)"
        subgraph "–°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ–π–∫–∞ 1"
            AD[Microsoft AD Domain Controller<br/>Windows Server 2019+<br/>192.168.1.10]
            DNS1[DNS-—Å–µ—Ä–≤–µ—Ä AD<br/>192.168.1.10]
        end
        
        subgraph "–°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ–π–∫–∞ 2"
            ALD[ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä<br/>Astra Linux<br/>192.168.1.20]
            DNS2[DNS-—Å–µ—Ä–≤–µ—Ä ALD<br/>192.168.1.20]
            SAMBA[Samba-—Å–µ—Ä–≤–µ—Ä<br/>Astra Linux<br/>192.168.1.30]
        end
        
        subgraph "–†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏"
            WIN[Windows –∫–ª–∏–µ–Ω—Ç—ã<br/>192.168.1.100-150]
            ASTRA[Astra Linux –∫–ª–∏–µ–Ω—Ç—ã<br/>192.168.1.200-250]
        end
    end
    
    AD -->|DNS-–∑–∞–ø—Ä–æ—Å—ã| DNS2
    ALD -->|DNS-–∑–∞–ø—Ä–æ—Å—ã| DNS1
    WIN -->|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è| AD
    WIN -->|–î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º| SAMBA
    ASTRA -->|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è| ALD
    ASTRA -->|–î–æ–≤–µ—Ä–∏–µ —á–µ—Ä–µ–∑ Samba| AD
```

### 2. –õ–æ–≥–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ–º–µ–Ω–æ–≤

```mermaid
graph LR
    subgraph "–î–æ–º–µ–Ω Windows"
        AD_DOMAIN[company.local<br/>Microsoft AD]
    end
    
    subgraph "–î–æ–º–µ–Ω Astra Linux"
        ALD_DOMAIN[astra.local<br/>ALD/FreeIPA]
    end
    
    subgraph "–ú–æ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
        SAMBA_DOMAIN[Samba Domain Member<br/>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω –∫ company.local]
    end
    
    AD_DOMAIN -->|–î–æ–≤–µ—Ä–∏–µ<br/>Kerberos Realm| ALD_DOMAIN
    SAMBA_DOMAIN -->|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è| AD_DOMAIN
    SAMBA_DOMAIN -->|–î–æ–ø. –ø–æ–ª–∏—Ç–∏–∫–∏| ALD_DOMAIN
```

---

## üìç –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### üñ• –°–µ—Ä–≤–µ—Ä Microsoft AD (company.local)
**–†–∞–∑–º–µ—â–µ–Ω–∏–µ:** –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ VM
**IP:** 192.168.1.10
**–†–æ–ª–∏:**
- ‚úÖ **Active Directory Domain Services**
- ‚úÖ **DNS-—Å–µ—Ä–≤–µ—Ä** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- ‚úÖ **DHCP-—Å–µ—Ä–≤–µ—Ä** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚ö†Ô∏è **–§–∞–π–ª–æ–≤—ã–µ —Å–ª—É–∂–±—ã** (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –Ω–∞ Samba)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ PowerShell
Get-ADDomain | Format-List Name, Forest, DomainMode
Get-DnsServerForwarder
```

### üêß –°–µ—Ä–≤–µ—Ä ALD (astra.local) 
**–†–∞–∑–º–µ—â–µ–Ω–∏–µ:** –í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –Ω–∞ Astra Linux
**IP:** 192.168.1.20
**–†–æ–ª–∏:**
- ‚úÖ **ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞**
- ‚úÖ **FreeIPA-—Å–µ—Ä–≤–∏—Å—ã** (Kerberos, LDAP)
- ‚úÖ **DNS-—Å–µ—Ä–≤–µ—Ä** (BIND)
- ‚úÖ **–í–µ–±-–∫–æ–Ω—Å–æ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** (https://ald-server.astra.local)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# –ù–∞ ALD-—Å–µ—Ä–≤–µ—Ä–µ
sudo astra-domain-admin
# –∏–ª–∏
sudo ald-provision --domain astra.local --ip-address 192.168.1.20
```

### üîó Samba-—Å–µ—Ä–≤–µ—Ä (–º–æ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
**–†–∞–∑–º–µ—â–µ–Ω–∏–µ:** –û—Ç–¥–µ–ª—å–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –Ω–∞ Astra Linux
**IP:** 192.168.1.30
**–†–æ–ª–∏:**
- ‚úÖ **–ß–ª–µ–Ω –¥–æ–º–µ–Ω–∞ company.local**
- ‚úÖ **–§–∞–π–ª–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä** –¥–ª—è –æ–±–æ–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ **–ü—Ä–æ–∫—Å–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** AD‚ÜíLinux
- ‚úÖ **–°–ª—É–∂–±–∞ –ø–µ—á–∞—Ç–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```bash
# –ù–∞ Samba-—Å–µ—Ä–≤–µ—Ä–µ
sudo apt install samba winbind
sudo net ads join -U administrator -S 192.168.1.10
```

---

## üåê –°–µ—Ç–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### DNS-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```mermaid
graph TD
    subgraph "DNS-–∑–æ–Ω–∞ company.local"
        DNS_AD[AD DNS<br/>192.168.1.10]
        DNS_AD -->|Conditional Forwarder| DNS_ALD
    end
    
    subgraph "DNS-–∑–æ–Ω–∞ astra.local" 
        DNS_ALD[ALD DNS<br/>192.168.1.20]
        DNS_ALD -->|Conditional Forwarder| DNS_AD
    end
    
    CLIENT[–ö–ª–∏–µ–Ω—Ç—ã] --> DNS_AD
    CLIENT --> DNS_ALD
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ DNS:**

**–ù–∞ AD-—Å–µ—Ä–≤–µ—Ä–µ (192.168.1.10):**
```powershell
# –î–æ–±–∞–≤–ª—è–µ–º conditional forwarder –¥–ª—è astra.local
Add-DnsServerConditionalForwarderZone -Name "astra.local" -MasterServers 192.168.1.20
```

**–ù–∞ ALD-—Å–µ—Ä–≤–µ—Ä–µ (192.168.1.20):**
```bash
# –í /etc/named/astra.local.forwarders.conf
zone "company.local" {
    type forward;
    forwarders { 192.168.1.10; };
};
```

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ä–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏

#### Windows-–∫–ª–∏–µ–Ω—Ç—ã (192.168.1.100-150)
**DNS-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –û—Å–Ω–æ–≤–Ω–æ–π DNS: 192.168.1.10 (AD)
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π DNS: 192.168.1.20 (ALD)

**–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å:** –î–æ–º–µ–Ω `company.local`

#### Astra Linux-–∫–ª–∏–µ–Ω—Ç—ã (192.168.1.200-250) 
**DNS-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –û—Å–Ω–æ–≤–Ω–æ–π DNS: 192.168.1.20 (ALD)
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π DNS: 192.168.1.10 (AD)

**–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å:** –î–æ–º–µ–Ω `astra.local`

---

## üìä –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Å–ª—É–∂–± –∏ –¥–∞–Ω–Ω—ã—Ö

### –§–∞–π–ª–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã
| –†–µ—Å—É—Ä—Å | –†–∞–∑–º–µ—â–µ–Ω–∏–µ | –î–æ—Å—Ç—É–ø –¥–ª—è | –ü—É—Ç—å |
|--------|------------|------------|------|
| –û–±—â–∏–µ –ø–∞–ø–∫–∏ Windows | Samba-—Å–µ—Ä–≤–µ—Ä (192.168.1.30) | AD + ALD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `/srv/samba/shared/` |
| –î–æ–º–∞—à–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏ AD | Samba-—Å–µ—Ä–≤–µ—Ä | AD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `/home/company/` |
| –î–æ–º–∞—à–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏ ALD | ALD-—Å–µ—Ä–≤–µ—Ä | ALD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `/home/astra/` |
| –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ | –û—Ç–¥–µ–ª—å–Ω—ã–π NAS | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã | `/backup/` |

### –°–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```mermaid
graph TB
    U[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] -->|–ó–∞–ø—Ä–æ—Å –≤—Ö–æ–¥–∞| C[–ö–ª–∏–µ–Ω—Ç]
    
    C -->|Windows-–∫–ª–∏–µ–Ω—Ç| AD_AUTH{–¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏}
    C -->|Linux-–∫–ª–∏–µ–Ω—Ç| ALD_AUTH{–¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏}
    
    AD_AUTH -->|AD —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ| AD[AD Server<br/>192.168.1.10]
    AD_AUTH -->|–ö—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–π –≤—Ö–æ–¥| SAMBA_AUTH[Samba<br/>192.168.1.30]
    
    ALD_AUTH -->|ALD —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ| ALD[ALD Server<br/>192.168.1.20] 
    ALD_AUTH -->|–ß–µ—Ä–µ–∑ –¥–æ–≤–µ—Ä–∏–µ| AD
    
    SAMBA_AUTH -->|–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ AD| AD
    SAMBA_AUTH -->|–î–æ–ø. –ø–æ–ª–∏—Ç–∏–∫–∏| ALD
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ù–∞ Samba-—Å–µ—Ä–≤–µ—Ä–µ (192.168.1.30)
**/etc/samba/smb.conf:**
```ini
[global]
    workgroup = COMPANY
    realm = COMPANY.LOCAL
    security = ads
    dns forwarder = 192.168.1.10
    
    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ALD
    idmap config * : backend = tdb
    idmap config * : range = 10000-999999

[shared]
    path = /srv/samba/shared
    valid users = @"COMPANY+Domain Users", @"astra.local+users"
```

### –ù–∞ –≤—Å–µ—Ö Linux-–º–∞—à–∏–Ω–∞—Ö
**/etc/krb5.conf:**
```ini
[libdefaults]
    default_realm = COMPANY.LOCAL
    dns_lookup_realm = true
    dns_lookup_kdc = true

[realms]
    COMPANY.LOCAL = {
        kdc = 192.168.1.10
        admin_server = 192.168.1.10
    }
    ASTRA.LOCAL = {
        kdc = 192.168.1.20
        admin_server = 192.168.1.20
    }
```

### –ù–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö
**/etc/resolv.conf:**
```bash
# –î–ª—è Windows-–∫–ª–∏–µ–Ω—Ç–æ–≤ (—á–µ—Ä–µ–∑ DHCP/DNS-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
nameserver 192.168.1.10
nameserver 192.168.1.20
search company.local astra.local
```

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | IP-–∞–¥—Ä–µ—Å | –†–æ–ª—å | –†–∞–∑–º–µ—â–µ–Ω–∏–µ |
|-----------|----------|------|------------|
| **Microsoft AD** | 192.168.1.10 | –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞ | –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä |
| **ALD-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä** | 192.168.1.20 | –î–æ–º–µ–Ω Astra Linux | VM –Ω–∞ Astra Linux |
| **Samba-—Å–µ—Ä–≤–µ—Ä** | 192.168.1.30 | –ú–æ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | VM –Ω–∞ Astra Linux |
| **Windows-–∫–ª–∏–µ–Ω—Ç—ã** | 192.168.1.100-150 | –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ | –§–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã |
| **Linux-–∫–ª–∏–µ–Ω—Ç—ã** | 192.168.1.200-250 | –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ | –§–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã |



## üéØ –ß—Ç–æ –º—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å

**–¶–µ–ª—å:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Å—Ç–µ–π—à—É—é —Å–≤—è–∑–∫—É –º–µ–∂–¥—É –¥–æ–º–µ–Ω–æ–º Windows –∏ –¥–æ–º–µ–Ω–æ–º Astra Linux, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ Windows –º–æ–≥–ª–∏ –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ Linux-–∫–æ–º–ø—å—é—Ç–µ—Ä—ã.

---

## üìã –®–ê–ì 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –ß—Ç–æ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:
1. **–°–µ—Ä–≤–µ—Ä Windows** —Å Active Directory (—É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å)
2. **–ß–∏—Å—Ç–∞—è Astra Linux** (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω—É—é –û–°)
3. **–°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**: –≤—Å–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏

### –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
- **–î–æ–º–µ–Ω Windows**: `company.local`
- **–î–æ–º–µ–Ω Astra Linux**: `astra.local`
- **IP Windows DC**: 192.168.1.10
- **IP Astra Linux**: 192.168.1.20

---

## üêß –®–ê–ì 1: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –¥–æ–º–µ–Ω –Ω–∞ Astra Linux (ALD)

### 1.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±
–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ Astra Linux –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –°—Ç–∞–≤–∏–º –¥–æ–º–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã
sudo apt update
sudo apt install astra-domain-common ald-server ald-admin

# –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
sudo astra-domain-setup
```

### 1.2 –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–ø—Ä–æ—â–µ –¥–ª—è –Ω–æ–≤–∏—á–∫–∞)
```bash
# –ó–∞–ø—É—Å–∫–∞–µ–º –≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é —É—Ç–∏–ª–∏—Ç—É
sudo astra-domain-admin
```

**–í –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —É—Ç–∏–ª–∏—Ç–µ:**
1. –í—ã–±–µ—Ä–∏—Ç–µ "**–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞**"
2. –ò–º—è –¥–æ–º–µ–Ω–∞: `astra.local`
3. –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: –ø—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
4. –ù–∞–∂–∏–º–∞–π—Ç–µ "–î–∞–ª–µ–µ" –ø–æ–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è


---

## üîó –®–ê–ì 2: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–≤—è–∑—å —Å –¥–æ–º–µ–Ω–æ–º Windows

### 2.1 –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º DNS
–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –ø—Ä–æ–ø–∏—Å–∞—Ç—å DNS-—Å–µ—Ä–≤–µ—Ä—ã –≤ Astra Linux:

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
sudo nano /etc/systemd/resolved.conf

# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏:
DNS=192.168.1.10  # IP –≤–∞—à–µ–≥–æ Windows DC
Domains=company.local
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ç—å:
```bash
sudo systemctl restart systemd-resolved
```

### 2.2 –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤—è–∑—å
```bash
# –î–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å Windows-–¥–æ–º–µ–Ω
nslookup company.local

# –î–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å Astra-–¥–æ–º–µ–Ω  
nslookup astra.local
```

---

## üîê –®–ê–ì 3: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Samba –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Windows

### 3.1 –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Samba
```bash
sudo apt install samba winbind libnss-winbind libpam-winbind
```

### 3.2 –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Samba
```bash
# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞
sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup

# –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥
sudo nano /etc/samba/smb.conf
```

**–í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç:**

```ini
[global]
    workgroup = COMPANY  # NetBIOS-–∏–º—è –≤–∞—à–µ–≥–æ Windows-–¥–æ–º–µ–Ω–∞
    realm = COMPANY.LOCAL  # –ü–æ–ª–Ω–æ–µ –∏–º—è Windows-–¥–æ–º–µ–Ω–∞
    security = ads
    idmap config * : backend = tdb
    idmap config * : range = 10000-999999
    winbind use default domain = yes
    winbind offline logon = yes
    template shell = /bin/bash
    template homedir = /home/%U
    
    # –í–∞–∂–Ω–æ! –£–∫–∞–∑—ã–≤–∞–µ–º –æ–±–∞ –¥–æ–º–µ–Ω–∞
    winbind trusted domains only = no
    winbind refresh tickets = yes

    # DNS-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    dns proxy = no
    dns forwarder = 192.168.1.10

[shared]
    path = /srv/samba/shared
    read only = no
    browseable = yes
    writable = yes
    guest ok = no
    valid users = @"COMPANY+Domain Users"
```

### 3.3 –°–æ–∑–¥–∞—ë–º –æ–±—â—É—é –ø–∞–ø–∫—É
```bash
# –°–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É
sudo mkdir -p /srv/samba/shared

# –î–∞—ë–º –ø—Ä–∞–≤–∞
sudo chmod 777 /srv/samba/shared

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Samba
sudo systemctl restart smbd nmbd winbind
```

---

## ü§ù –®–ê–ì 4: –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º Astra Linux –∫ –¥–æ–º–µ–Ω—É Windows

### 4.1 –í—Å—Ç—É–ø–∞–µ–º –≤ –¥–æ–º–µ–Ω
```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Windows
sudo net ads join -U administrator
```

**–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Windows –∫–æ–≥–¥–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç.**

### 4.2 –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
sudo nano /etc/nsswitch.conf
```

**–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –∏ –¥–æ–±–∞–≤—å—Ç–µ winbind:**
```
passwd:    files systemd winbind
group:     files systemd winbind
shadow:    files winbind
```

### 4.3 –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º PAM (–≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É)
```bash
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –º–æ–¥—É–ª–∏
sudo apt install libpam-winbind

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º PAM
sudo pam-auth-update
```

**–í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ:**
- [‚úì] Winbind NT/Active Directory authentication
- –ù–∞–∂–º–∏—Ç–µ OK

---

## ‚úÖ –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É

### 5.1 –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Windows
```bash
# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Windows
wbinfo -u

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≥—Ä—É–ø–ø—ã –∏–∑ Windows  
wbinfo -g

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
getent passwd administrator@company.local
```

### 5.2 –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—â—É—é –ø–∞–ø–∫—É
**–° –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ Windows:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ü—Ä–æ–≤–æ–¥–Ω–∏–∫
2. –í –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤–≤–µ–¥–∏—Ç–µ: `\\192.168.1.20\shared`
3. –î–æ–ª–∂–µ–Ω –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å
4. –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω: `COMPANY\administrator` –∏ –ø–∞—Ä–æ–ª—å

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –ø–∞–ø–∫—É - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!**

### 5.3 –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Windows
–ù–∞ Astra Linux:
```bash
# –ü—Ä–æ–±—É–µ–º –∑–∞–π—Ç–∏ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º Windows
su - administrator@company.local
```

---

## üîÑ –®–ê–ì 6: –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±)

### 6.1 –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Windows
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Windows –æ—Ç–∫—Ä–æ–π—Ç–µ **PowerShell** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```powershell
# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
Get-ADUser -Filter * | Select-Object Name, SamAccountName | Export-CSV C:\users.csv -Encoding UTF8
```

### 6.2 –°–æ–∑–¥–∞—ë–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ ALD
–ù–∞ Astra Linux —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç:

```bash
# –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
nano migrate_users.sh
```

**–î–æ–±–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

```bash
#!/bin/bash

# –ü—Ä–∏–º–µ—Ä —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ CSV –≤—ã–ø–æ–ª–Ω—è–µ–º:

sudo ipa user-add ivannov --first=Ivan --last=Novikov --password
sudo ipa user-add petrov --first=Petr --last=Petrov --password

echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–¥–∞—Ç—å –∏–º –ø–∞—Ä–æ–ª–∏!"
```

```bash
# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x migrate_users.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º
./migrate_users.sh
```

---

## üõ† –®–ê–ì 7: –†–µ—à–µ–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –Ω–µ –≤—Å—Ç—É–ø–∞–µ—Ç –≤ –¥–æ–º–µ–Ω:
```bash
# –û—á–∏—â–∞–µ–º –∫—ç—à
sudo net cache flush

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–ª—É–∂–±—ã
sudo systemctl restart winbind samba-ad-dc
```

### –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫—ç—à
sudo wbinfo --pam-logon COMPANY/administrator
```

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å DNS:
```bash
# –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º DNS –Ω–∞–ø—Ä—è–º—É—é
echo "nameserver 192.168.1.10" | sudo tee /etc/resolv.conf
```

---

## üìä –ß—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤ –∏—Ç–æ–≥–µ:

- ‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Windows** –º–æ–≥—É—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã Astra Linux
- ‚úÖ **–ï—Å—Ç—å –æ–±—â–∏–µ –ø–∞–ø–∫–∏** –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–∑ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º  
- ‚úÖ **–ú–æ–∂–Ω–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å** - —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ ALD –∏ –æ—Ç–∫–ª—é—á–∞—Ç—å –∏—Ö –≤ AD
- ‚úÖ **–ü—Ä–æ—Å—Ç–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏

---



**–î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:**
1. –ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ 2-3 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ AD –≤ ALD
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –Ω–∏—Ö –¥–æ—Å—Ç—É–ø –∫ –æ–±—â–∏–º –ø–∞–ø–∫–∞–º
3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

